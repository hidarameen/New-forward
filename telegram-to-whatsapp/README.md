# نظام توجيه تليجرام إلى واتساب 🌉

نظام متطور وشامل لتوجيه الرسائل من قنوات تليجرام إلى واتساب تلقائياً مع واجهة إدارة حديثة.

## المميزات الرئيسية ✨

### 🔄 **التوجيه التلقائي**
- مراقبة قنوات تليجرام في الوقت الفعلي
- توجيه الرسائل إلى عدة أرقام واتساب
- معالجة الرسائل المعلقة عند انقطاع الاتصال
- تأخير قابل للتخصيص بين الرسائل

### 🎛️ **لوحة تحكم متقدمة**
- واجهة ويب حديثة باللغة العربية
- تسجيل دخول واتساب عبر QR Code
- إدارة الإعدادات في الوقت الفعلي
- مراقبة الحالة والإحصائيات

### 🔍 **نظام فلترة ذكي**
- فلترة الرسائل بالكلمات المفتاحية
- تخصيص قالب الرسائل
- إضافة معلومات إضافية (الوقت، اسم القناة)
- تحديد طول الرسائل المسموح

### 📊 **إحصائيات شاملة**
- عدد الرسائل المُوجهة والمُفلترة
- تتبع الأخطاء والنشاط
- سجل الأنشطة المفصل
- إحصائيات يومية وإجمالية

### 🔒 **الأمان والموثوقية**
- حفظ الجلسات تلقائياً
- معالجة الأخطاء المتقدمة
- إعادة الاتصال التلقائي
- حماية البيانات الحساسة

## المتطلبات 📋

### البرمجيات المطلوبة
- **Node.js** (الإصدار 16 أو أحدث)
- **Python** (الإصدار 3.7 أو أحدث)
- **npm** أو **yarn**
- **pip** (لإدارة حزم Python)

### الحسابات المطلوبة
- حساب تليجرام
- بوت تليجرام (من @BotFather)
- حساب واتساب

## التثبيت السريع 🚀

### 1. تحميل المشروع

```bash
# استنساخ المشروع
git clone <repository-url>
cd telegram-to-whatsapp

# أو تحميل الملفات يدوياً
```

### 2. تثبيت التبعيات

```bash
# تبعيات Node.js
npm install

# تبعيات Python
pip install -r requirements.txt
```

### 3. إعداد متغيرات البيئة

```bash
# نسخ ملف الإعدادات
cp .env.example .env

# تحرير الملف وإضافة توكن البوت
nano .env
```

أضف توكن البوت الخاص بك:
```env
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
WHATSAPP_API_URL=http://localhost:3000/api/forward
PORT=3000
```

### 4. تشغيل النظام

```bash
# تشغيل خادم واتساب
npm start

# في terminal آخر - تشغيل بوت تليجرام
npm run telegram
```

أو استخدم سكريبت التشغيل التلقائي:
```bash
chmod +x start.sh
./start.sh
```

## الإعداد التفصيلي 🔧

### إنشاء بوت تليجرام

1. **ابحث عن @BotFather** في تليجرام
2. **أرسل `/newbot`** واتبع التعليمات
3. **احفظ التوكن** المُرسل من BotFather
4. **أضف التوكن** في ملف `.env`

### إعداد القنوات

1. **أضف البوت كمشرف** في القناة المراد مراقبتها
2. **احصل على معرف القناة** (Channel ID)
3. **أضف المعرف** في لوحة التحكم

### تسجيل دخول واتساب

1. **افتح لوحة التحكم**: `http://localhost:3000`
2. **امسح QR Code** بتطبيق واتساب
3. **انتظر** تأكيد الاتصال

## الاستخدام 💬

### تفعيل النظام

1. **افتح لوحة التحكم** في المتصفح
2. **تأكد من اتصال واتساب** (QR Code)
3. **أضف أرقام واتساب المستهدفة**
4. **أضف قنوات تليجرام للمراقبة**
5. **فعّل نظام التوجيه** من المفتاح

### إدارة الإعدادات

#### أرقام واتساب المستهدفة
```
+966501234567
+971501234567
+20123456789
```

#### معرفات قنوات تليجرام
```
-1001234567890
-1009876543210
```

#### الكلمات المفتاحية (اختياري)
```
عاجل
خبر
إعلان
```

#### قالب الرسالة المخصص
```
📢 من: {channel}
💬 {message}
⏰ {time}
```

المتغيرات المتاحة:
- `{message}` - نص الرسالة
- `{channel}` - اسم القناة
- `{time}` - التاريخ والوقت

## الميزات المتقدمة 🎯

### فلترة الرسائل

```javascript
// مثال: فلترة الرسائل التي تحتوي على كلمات محددة
keywords_filter: ["عاجل", "خبر", "إعلان"]

// مثال: توجيه جميع الرسائل (قائمة فارغة)
keywords_filter: []
```

### تخصيص التوقيت

```javascript
// تأخير بين الرسائل (بالثواني)
message_delay: 2

// الحد الأقصى لطول الرسالة
max_message_length: 4000
```

### إعدادات الرسائل

```javascript
// إضافة اسم القناة
addChannelName: true

// إضافة التاريخ والوقت
addTimestamp: true

// قالب مخصص للرسالة
messageTemplate: "📢 من: {channel}\n\n{message}\n\n⏰ {time}"
```

## مراقبة النظام 📊

### الإحصائيات المتاحة

- **الرسائل المستلمة**: من تليجرام
- **الرسائل المُوجهة**: إلى واتساب
- **الرسائل المُفلترة**: بناءً على الكلمات المفتاحية
- **الأخطاء**: عدد الأخطاء المسجلة

### سجل الأنشطة

يتم تسجيل جميع الأنشطة مع:
- الوقت والتاريخ
- نوع النشاط
- تفاصيل العملية

### ملفات السجلات

```
logs/
├── telegram_bot.log          # سجلات بوت تليجرام
├── whatsapp.log             # سجلات واتساب
└── system.log               # سجلات النظام العامة
```

## استكشاف الأخطاء 🔧

### مشاكل شائعة وحلولها

#### 1. البوت لا يستقبل رسائل من القناة

**الحل:**
```bash
# تأكد من أن البوت مشرف في القناة
# تحقق من معرف القناة الصحيح
# راجع سجلات البوت
tail -f logs/telegram_bot.log
```

#### 2. واتساب لا يتصل

**الحل:**
```bash
# إعادة تشغيل خادم واتساب
npm run restart-whatsapp

# مسح بيانات الجلسة وإعادة المحاولة
rm -rf .wwebjs_auth
npm start
```

#### 3. الرسائل لا تُوجه

**الحل:**
- تأكد من تفعيل نظام التوجيه
- تحقق من أرقام واتساب المستهدفة
- راجع الكلمات المفتاحية
- تحقق من حالة اتصال واتساب

#### 4. أخطاء في التوكن

**الحل:**
```bash
# تحقق من ملف .env
cat .env

# تأكد من صحة التوكن
# أعد إنشاء البوت إذا لزم الأمر
```

### فحص السجلات

```bash
# سجلات بوت تليجرام
tail -f logs/telegram_bot.log

# سجلات النظام
npm run logs

# فحص حالة النظام
curl http://localhost:3000/api/status
```

## الأمان 🔒

### نصائح مهمة

1. **احم ملف `.env`** - لا تشاركه مع أحد
2. **استخدم شبكة آمنة** للاتصال
3. **راقب السجلات** للأنشطة المشبوهة
4. **قم بالنسخ الاحتياطي** للإعدادات
5. **حدث النظام** بانتظام

### في بيئة الإنتاج

```bash
# استخدم HTTPS
# قم بإعداد firewall
# استخدم معرفات مستخدمين محددة
# فعّل المراقبة والتنبيهات
```

## API Reference 📚

### REST Endpoints

#### GET `/api/status`
```json
{
  "whatsapp": {
    "isReady": true,
    "clientInfo": {...}
  },
  "forwarding": {...},
  "stats": {...}
}
```

#### POST `/api/config`
```json
{
  "enabled": true,
  "targetNumbers": ["+966501234567"],
  "sourceChannels": ["-1001234567890"],
  "keywords_filter": ["عاجل"]
}
```

#### POST `/api/forward`
```json
{
  "text": "نص الرسالة",
  "channelName": "اسم القناة",
  "channelId": "-1001234567890"
}
```

### Socket.IO Events

#### من الخادم:
- `qr` - باركود QR جديد
- `whatsapp_ready` - واتساب جاهز
- `message_forwarded` - تم توجيه رسالة
- `config_updated` - تم تحديث الإعدادات

#### إلى الخادم:
- `restart_whatsapp` - إعادة تشغيل واتساب
- `update_config` - تحديث الإعدادات

## هيكل المشروع 📁

```
telegram-to-whatsapp/
├── app.js                   # خادم Node.js الرئيسي
├── telegram_bot.py         # بوت تليجرام
├── package.json            # تبعيات Node.js
├── requirements.txt        # تبعيات Python
├── .env.example           # مثال إعدادات البيئة
├── README.md              # هذا الملف
├── start.sh               # سكريبت تشغيل تلقائي
├── public/                # ملفات الواجهة
│   ├── index.html        # الصفحة الرئيسية
│   ├── style.css         # تنسيق الصفحة
│   └── script.js         # JavaScript العميل
├── logs/                 # ملفات السجلات
├── .wwebjs_auth/         # بيانات جلسة واتساب
├── config.json           # ملف الإعدادات
└── stats.json            # ملف الإحصائيات
```

## التطوير والمساهمة 👨‍💻

### إعداد بيئة التطوير

```bash
# تثبيت أدوات التطوير
npm install -g nodemon

# تشغيل وضع التطوير
npm run dev

# تشغيل الاختبارات
npm test
```

### إضافة ميزات جديدة

1. **Fork** المشروع
2. **إنشاء فرع جديد** للميزة
3. **كتابة الكود** مع التعليقات
4. **اختبار الميزة** جيداً
5. **إرسال Pull Request**

## الدعم والمساعدة 💬

### للحصول على المساعدة:

1. **راجع الأسئلة الشائعة** في هذا الملف
2. **تحقق من السجلات** لمعرفة الأخطاء
3. **ابحث في Issues** الموجودة
4. **أنشئ Issue جديد** مع وصف مفصل

### معلومات مفيدة:

- **لوحة التحكم**: http://localhost:3000
- **API الحالة**: http://localhost:3000/api/status
- **ملفات السجلات**: `logs/`

## الترخيص 📝

هذا المشروع مرخص تحت رخصة MIT - راجع ملف `LICENSE` للتفاصيل.

## إخلاء المسؤولية ⚠️

- هذا المشروع **للأغراض التعليمية والشخصية**
- **ليس مُصرحاً** رسمياً من تليجرام أو واتساب
- **استخدم بحذر** وعلى مسؤوليتك الشخصية
- **تأكد من الامتثال** لشروط خدمة المنصات
- **لا تستخدم** لإرسال رسائل غير مرغوب فيها

## الإصدارات والتحديثات 🔄

### الإصدار الحالي: 1.0.0

**المميزات:**
- ✅ توجيه أساسي من تليجرام إلى واتساب
- ✅ لوحة تحكم ويب
- ✅ فلترة الرسائل
- ✅ إحصائيات مفصلة
- ✅ واجهة عربية كاملة

**قريباً:**
- 📝 دعم الصور والملفات
- 🤖 رد تلقائي على الرسائل
- 📱 تطبيق موبايل
- 🔔 تنبيهات متقدمة

---

**صُنع بـ ❤️ للمجتمع العربي**

*آخر تحديث: 2024*